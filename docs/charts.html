<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Chart types | Graphic Design with ggplot2</title>
  <meta name="description" content="Create Beautiful, Publication–Ready Data Visualizations in R" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Chart types | Graphic Design with ggplot2" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Create Beautiful, Publication–Ready Data Visualizations in R" />
  <meta name="github-repo" content="z3tt/graphic-design-ggplot2" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Chart types | Graphic Design with ggplot2" />
  
  <meta name="twitter:description" content="Create Beautiful, Publication–Ready Data Visualizations in R" />
  

<meta name="author" content="Cédric Scherer" />


<meta name="date" content="2021-09-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="setup.html"/>
<link rel="next" href="themes.html"/>
<script src="libs/header-attrs/header-attrs.js"></script>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Graphic Design with ggplot2</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-read-this-book"><i class="fa fa-check"></i>Why read this book</a></li>
<li><a href="index.html#why-r-and-ggplot2">Why R and <strong>ggplot2</strong></a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#structure-of-the-book"><i class="fa fa-check"></i>Structure of the book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-information-and-conventions"><i class="fa fa-check"></i>Software information and conventions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the Author</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="setup.html"><a href="setup.html"><i class="fa fa-check"></i><b>2</b> Setup</a>
<ul>
<li class="chapter" data-level="2.1" data-path="setup.html"><a href="setup.html#data"><i class="fa fa-check"></i><b>2.1</b> The Dataset</a></li>
<li class="chapter" data-level="2.2" data-path="setup.html"><a href="setup.html#ggplot"><i class="fa fa-check"></i><b>2.2</b> The <strong>ggplot2</strong> Package</a></li>
<li class="chapter" data-level="2.3" data-path="setup.html"><a href="setup.html#default"><i class="fa fa-check"></i><b>2.3</b> A Basic ggplot</a></li>
<li class="chapter" data-level="2.4" data-path="setup.html"><a href="setup.html#prop"><i class="fa fa-check"></i><b>2.4</b> Change Properties of Geometries</a></li>
<li class="chapter" data-level="2.5" data-path="setup.html"><a href="setup.html#theme"><i class="fa fa-check"></i><b>2.5</b> Replace the default <strong>ggplot2</strong> theme</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="charts.html"><a href="charts.html"><i class="fa fa-check"></i><b>3</b> Chart types</a>
<ul>
<li class="chapter" data-level="3.1" data-path="charts.html"><a href="charts.html#alternatives-to-a-box-plot"><i class="fa fa-check"></i><b>3.1</b> Alternatives to a Box Plot</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="charts.html"><a href="charts.html#dot-plots"><i class="fa fa-check"></i><b>3.1.1</b> Dot Plots</a></li>
<li class="chapter" data-level="3.1.2" data-path="charts.html"><a href="charts.html#strip-plots"><i class="fa fa-check"></i><b>3.1.2</b> Strip Plots</a></li>
<li class="chapter" data-level="3.1.3" data-path="charts.html"><a href="charts.html#violin-plots"><i class="fa fa-check"></i><b>3.1.3</b> Violin Plots</a></li>
<li class="chapter" data-level="3.1.4" data-path="charts.html"><a href="charts.html#combining-violin-plots-with-strip-charts"><i class="fa fa-check"></i><b>3.1.4</b> Combining Violin Plots with Strip Charts</a></li>
<li class="chapter" data-level="3.1.5" data-path="charts.html"><a href="charts.html#combining-violin-and-box-plots"><i class="fa fa-check"></i><b>3.1.5</b> Combining Violin and Box Plots</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="charts.html"><a href="charts.html#create-a-rug-representation-to-a-plot"><i class="fa fa-check"></i><b>3.2</b> Create a Rug Representation to a Plot</a></li>
<li class="chapter" data-level="3.3" data-path="charts.html"><a href="charts.html#create-a-correlation-matrix"><i class="fa fa-check"></i><b>3.3</b> Create a Correlation Matrix</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="themes.html"><a href="themes.html"><i class="fa fa-check"></i><b>4</b> Themes</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="more-to-say.html"><a href="more-to-say.html"><i class="fa fa-check"></i><b>A</b> More to Say</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://cedricscherer.com">Written by Cédric Scherer</a></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Graphic Design with ggplot2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="charts" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Chart types</h1>
<div id="alternatives-to-a-box-plot" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Alternatives to a Box Plot</h2>
<p>A box plot is probably the most commonly used chart type to compare distribution of several groups, at least in the scientific literature. Box plots are great, but they can be so incredibly boring. Also, even if you are used to looking at box plots, remember there might be plenty people looking at your plot that have never seen a box and whisker plot before.</p>
<p>A box-and-whisker plot (sometimes called simply a box plot) is a histogram-like method of displaying data, invented by J. Tukey. The thick <em>middle line</em> notates the median, also known as quartile. The limits of the <em>box</em> are determined by the lower and upper quartiles, <em>Q¹</em> and <em>Q³</em>. The box contains thus 50% of the data and is called <em>interquartile range</em> (IQR). The length of the <em>whiskers</em> is determined by the most extreme values that are not considered as outliers (i.e. values that are within 3/2 times the interquartile range).</p>
<div class="figure"><span id="fig:img-boxplot"></span>
<img src="img/boxplot.png" alt="A boxplot is a standardized way of displaying the dataset based on a five-number summary: the minimum, the maximum, the sample median, and the first and third quartiles." width="100%" />
<p class="caption">
FIGURE 3.1: A boxplot is a standardized way of displaying the dataset based on a five-number summary: the minimum, the maximum, the sample median, and the first and third quartiles.
</p>
</div>
<p>There are alternatives, but first we are plotting a common box plot:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="charts.html#cb19-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span></span>
<span id="cb19-2"><a href="charts.html#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(chic, <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> o3,</span>
<span id="cb19-3"><a href="charts.html#cb19-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb19-4"><a href="charts.html#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Season&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Ozone&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-5"><a href="charts.html#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>, <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb19-6"><a href="charts.html#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="charts.html#cb19-7" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<div class="figure"><span id="fig:boxplot"></span>
<img src="bookdown_files/figure-html/boxplot-1.png" alt="A box plot generated with **ggplot2** with customized axis labels and colors." width="672" />
<p class="caption">
FIGURE 3.2: A box plot generated with <strong>ggplot2</strong> with customized axis labels and colors.
</p>
</div>
<div id="dot-plots" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Dot Plots</h3>
<p>Let’s plot just each data point of the raw data:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="charts.html#cb20-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<div class="figure"><span id="fig:point"></span>
<img src="bookdown_files/figure-html/point-1.png" alt="A dot plot visualizing the distribution of the raw data as an alternative to boxplots. However, the summary statistics are not shown anymore." width="672" />
<p class="caption">
FIGURE 3.3: A dot plot visualizing the distribution of the raw data as an alternative to boxplots. However, the summary statistics are not shown anymore.
</p>
</div>
<p>Not only boring but uninformative. To improve the plot, one could add transparency to deal with overplotting:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="charts.html#cb21-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">1</span>)</span></code></pre></div>
<div class="figure"><span id="fig:point-alpha"></span>
<img src="bookdown_files/figure-html/point-alpha-1.png" alt="A dot plot with added transparency as an approach to make overlapping data points visible." width="672" />
<p class="caption">
FIGURE 3.4: A dot plot with added transparency as an approach to make overlapping data points visible.
</p>
</div>
<p>However, setting transparency is difficult here since either the overlap is still too high or the extreme values are not visible. Bad, so let’s try something else.</p>
</div>
<div id="strip-plots" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Strip Plots</h3>
<p>Try adding a little jitter to the data. I like this for in-house visualization but be careful using jittering because you are purposely adding noise to your data and this can result in misinterpretation of your data.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="charts.html#cb22-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">width =</span> .<span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">5</span>)</span></code></pre></div>
<div class="figure"><span id="fig:jitter"></span>
<img src="bookdown_files/figure-html/jitter-1.png" alt="A jittered dot plot, also known as strip plot." width="672" />
<p class="caption">
FIGURE 3.5: A jittered dot plot, also known as strip plot.
</p>
</div>
</div>
<div id="violin-plots" class="section level3" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Violin Plots</h3>
<p>Violin plots, similar to box plots except you are using a kernel density to show where you have the most data, are a useful visualization.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="charts.html#cb23-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="st">&quot;gray80&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> .<span class="dv">5</span>)</span></code></pre></div>
<div class="figure"><span id="fig:violin"></span>
<img src="bookdown_files/figure-html/violin-1.png" alt="Violin plots are a great way to visualize the distribution values, especially in case of large sample sizes." width="672" />
<p class="caption">
FIGURE 3.6: Violin plots are a great way to visualize the distribution values, especially in case of large sample sizes.
</p>
</div>
</div>
<div id="combining-violin-plots-with-strip-charts" class="section level3" number="3.1.4">
<h3><span class="header-section-number">3.1.4</span> Combining Violin Plots with Strip Charts</h3>
<p>We can of course combine both, estimated densities and the raw data points:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="charts.html#cb24-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="st">&quot;gray80&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb24-2"><a href="charts.html#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> .<span class="dv">25</span>, <span class="at">width =</span> .<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb24-3"><a href="charts.html#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>()</span></code></pre></div>
<div class="figure"><span id="fig:violin-jitter"></span>
<img src="bookdown_files/figure-html/violin-jitter-1.png" alt="A combination of violin and strip plots to visualize the distribution and the raw values at the same time." width="672" />
<p class="caption">
FIGURE 3.7: A combination of violin and strip plots to visualize the distribution and the raw values at the same time.
</p>
</div>
<p>The <a href="https://ggforce.data-imaginist.com/"><strong>ggforce</strong> package</a> provides so-called sina functions where the width of the jitter is controlled by the density distribution of the data—that makes the jittering a bit more visually appealing:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="charts.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb25-2"><a href="charts.html#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="charts.html#cb25-3" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="st">&quot;gray80&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb25-4"><a href="charts.html#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sina</span>(<span class="at">alpha =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="charts.html#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>()</span></code></pre></div>
<div class="figure"><span id="fig:violin-sina"></span>
<img src="bookdown_files/figure-html/violin-sina-1.png" alt="A sina plot places the dots according to the distribution and is basically a *raw data violin plot*." width="672" />
<p class="caption">
FIGURE 3.8: A sina plot places the dots according to the distribution and is basically a <em>raw data violin plot</em>.
</p>
</div>
</div>
<div id="combining-violin-and-box-plots" class="section level3" number="3.1.5">
<h3><span class="header-section-number">3.1.5</span> Combining Violin and Box Plots</h3>
<p>To allow for easy estimation of quantiles, we can also add the box of the box plot inside the violins to indicate 25%-quartile, median and 75%-quartile:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="charts.html#cb26-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> season), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb26-2"><a href="charts.html#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">outlier.alpha =</span> <span class="dv">0</span>, <span class="at">coef =</span> <span class="dv">0</span>,</span>
<span id="cb26-3"><a href="charts.html#cb26-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;gray40&quot;</span>, <span class="at">width =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb26-4"><a href="charts.html#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>, <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-5"><a href="charts.html#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>()</span></code></pre></div>
<div class="figure"><span id="fig:violin-jitter-box"></span>
<img src="bookdown_files/figure-html/violin-jitter-box-1.png" alt="A combination of violin and box plots to visualize the distribution and the summary statistics of each group." width="672" />
<p class="caption">
FIGURE 3.9: A combination of violin and box plots to visualize the distribution and the summary statistics of each group.
</p>
</div>
</div>
</div>
<div id="create-a-rug-representation-to-a-plot" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Create a Rug Representation to a Plot</h2>
<p>A rug represents the data of a single quantitative variable, displayed as marks along an axis. In most cases, it is used in addition to scatter plots or heatmaps to visualize the overall distribution of one or both of the variables:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="charts.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(chic, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> temp,</span>
<span id="cb27-2"><a href="charts.html#cb27-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb27-3"><a href="charts.html#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb27-4"><a href="charts.html#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb27-5"><a href="charts.html#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Temperature (°F)&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:rug"></span>
<img src="bookdown_files/figure-html/rug-1.png" alt="A so-called rug or bardcode plot is a powerful way to highlight the distribution along one axis without requiring much more space." width="672" />
<p class="caption">
FIGURE 3.10: A so-called rug or bardcode plot is a powerful way to highlight the distribution along one axis without requiring much more space.
</p>
</div>
</div>
<div id="create-a-correlation-matrix" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Create a Correlation Matrix</h2>
<p>There are several packages that allow to create correlation matrix plots, some also using the <strong>ggplot2</strong> infrastructure and thus returning ggplots. I am going to show you how to do this without extension packages.</p>
<p>First step is to create the correlation matrix. Here, we use the <strong>corrr</strong> package that works nicely with pipes but there are also many others out there. We are using Pearson because all the variables are fairly normally distributed (but you may consider Spearman if your variables follow a different pattern). Note that since a correlation matrix has redundant information we are setting half of it to <code>NA</code>.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="charts.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb28-2"><a href="charts.html#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="charts.html#cb28-3" aria-hidden="true" tabindex="-1"></a>corm <span class="ot">&lt;-</span></span>
<span id="cb28-4"><a href="charts.html#cb28-4" aria-hidden="true" tabindex="-1"></a>  chic <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="charts.html#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(death, temp, dewpoint, pm10, o3) <span class="sc">%&gt;%</span></span>
<span id="cb28-6"><a href="charts.html#cb28-6" aria-hidden="true" tabindex="-1"></a>  corrr<span class="sc">::</span><span class="fu">correlate</span>(<span class="at">diagonal =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-7"><a href="charts.html#cb28-7" aria-hidden="true" tabindex="-1"></a>  corrr<span class="sc">::</span><span class="fu">shave</span>(<span class="at">upper =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## 
## Correlation method: &#39;pearson&#39;
## Missing treated using: &#39;pairwise.complete.obs&#39;</code></pre>
<pre><code>## # A tibble: 5 x 6
##   term     death   temp dewpoint     pm10     o3
##   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;
## 1 death        1 -0.486   -0.465 -0.00294 -0.238
## 2 temp        NA  1        0.958  0.368    0.535
## 3 dewpoint    NA NA        1      0.327    0.454
## 4 pm10        NA NA       NA      1        0.206
## 5 o3          NA NA       NA     NA        1</code></pre>
<p>Now we put the resulting matrix in <em>long</em> format using the <code>pivot_longer()</code> function from the <strong>tidyr</strong> package:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="charts.html#cb31-1" aria-hidden="true" tabindex="-1"></a>corm <span class="ot">&lt;-</span> corm <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="charts.html#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb31-3"><a href="charts.html#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="sc">-</span>term,</span>
<span id="cb31-4"><a href="charts.html#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;colname&quot;</span>,</span>
<span id="cb31-5"><a href="charts.html#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;corr&quot;</span></span>
<span id="cb31-6"><a href="charts.html#cb31-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-7"><a href="charts.html#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rowname =</span> <span class="fu">fct_inorder</span>(term),</span>
<span id="cb31-8"><a href="charts.html#cb31-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">colname =</span> <span class="fu">fct_inorder</span>(colname))</span></code></pre></div>
<pre><code>## # A tibble: 25 x 4
##    term  colname      corr rowname
##    &lt;chr&gt; &lt;fct&gt;       &lt;dbl&gt; &lt;fct&gt;  
##  1 death death     1       death  
##  2 death temp     -0.486   death  
##  3 death dewpoint -0.465   death  
##  4 death pm10     -0.00294 death  
##  5 death o3       -0.238   death  
##  6 temp  death    NA       temp   
##  7 temp  temp      1       temp   
##  8 temp  dewpoint  0.958   temp   
##  9 temp  pm10      0.368   temp   
## 10 temp  o3        0.535   temp   
## # ... with 15 more rows</code></pre>
<p>For the plot we will use <code>geom_tile()</code> for the heatmap and <code>geom_text()</code> for the labels:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="charts.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(corm, <span class="fu">aes</span>(rowname, <span class="fu">fct_rev</span>(colname),</span>
<span id="cb33-2"><a href="charts.html#cb33-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> corr)) <span class="sc">+</span></span>
<span id="cb33-3"><a href="charts.html#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb33-4"><a href="charts.html#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(corr, <span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb33-5"><a href="charts.html#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb33-6"><a href="charts.html#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 10 rows containing missing values
## (geom_text).</code></pre>
<div class="figure"><span id="fig:tile-corr-plot"></span>
<img src="bookdown_files/figure-html/tile-corr-plot-1.png" alt="A basic correlation plot, created with our prepared correlation data set and the help of `geom_tile()`." width="672" />
<p class="caption">
FIGURE 3.11: A basic correlation plot, created with our prepared correlation data set and the help of <code>geom_tile()</code>.
</p>
</div>
<p>I like to have a diverging color palette, centered at zero correlation, with white indicating missing data. Also I like to have no grid lines and padding around the heatmap as well as nicely formatted labels that are colored depending on the underlying fill:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="charts.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(corm, <span class="fu">aes</span>(rowname, <span class="fu">fct_rev</span>(colname),</span>
<span id="cb35-2"><a href="charts.html#cb35-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> corr)) <span class="sc">+</span></span>
<span id="cb35-3"><a href="charts.html#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb35-4"><a href="charts.html#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(</span>
<span id="cb35-5"><a href="charts.html#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">format</span>(<span class="fu">round</span>(corr, <span class="dv">2</span>), <span class="at">nsmall =</span> <span class="dv">2</span>),</span>
<span id="cb35-6"><a href="charts.html#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">abs</span>(corr) <span class="sc">&lt;</span> .<span class="dv">75</span></span>
<span id="cb35-7"><a href="charts.html#cb35-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb35-8"><a href="charts.html#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb35-9"><a href="charts.html#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;black&quot;</span>),</span>
<span id="cb35-10"><a href="charts.html#cb35-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb35-11"><a href="charts.html#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(</span>
<span id="cb35-12"><a href="charts.html#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">&quot;PuOr&quot;</span>, <span class="at">na.value =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb35-13"><a href="charts.html#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="dv">1</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb35-14"><a href="charts.html#cb35-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-15"><a href="charts.html#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb35-16"><a href="charts.html#cb35-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="cn">NA</span>),</span>
<span id="cb35-17"><a href="charts.html#cb35-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">85</span>, .<span class="dv">8</span>))</span></code></pre></div>
<div class="figure"><span id="fig:tile-corr-plot-polished"></span>
<img src="bookdown_files/figure-html/tile-corr-plot-polished-1.png" alt="A polished version of the same correlation plot with custom color palettes and theme adjustments." width="672" />
<p class="caption">
FIGURE 3.12: A polished version of the same correlation plot with custom color palettes and theme adjustments.
</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="setup.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="themes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yihui/bookdown-crc/edit/master/03-charts.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown.pdf", "bookdown.epub"],
"toc": {
"collapse": "none"
}
});
});
</script>

</body>

</html>
